<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login - Agência Maravilha</title>
<link rel="icon" type="image/png" href="assets/favicon.png">

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- CSS global da agência -->
<link href="assets/styles.css" rel="stylesheet">
</head>
<body>

<div class="d-flex justify-content-center align-items-center vh-100">
  <div class="login-card text-center p-4">
    <img src="assets/logo.jpg" class="logo mb-3" alt="Logo" style="width:100px;">
    <h3 class="mb-3">Login/Admin</h3>

    <input type="email" id="email" placeholder="Email" class="form-control mb-3">
    <input type="password" id="senha" placeholder="Senha" class="form-control mb-3">
    <button id="btnLogin" class="btn btn-brand btn-sm">Entrar</button>

    <p id="msg" class="mt-3 fw-bold"></p>
  </div>
</div>

<script type="module">
  import { supabase } from "./supabase.js"; // supabase.js deve estar na mesma pasta

  const btnLogin = document.getElementById("btnLogin");
  const msg = document.getElementById("msg");

  btnLogin.addEventListener("click", async () => {
    const email = document.getElementById("email").value;
    const senha = document.getElementById("senha").value;

    if (!email || !senha) {
      msg.style.color = "#f87171"; // vermelho
      msg.textContent = "Preencha todos os campos";
      return;
    }

    msg.style.color = "white";
    msg.textContent = "Verificando...";

    try {
      const { data, error } = await supabase.auth.signInWithPassword({
        email,
        password: senha
      });

      if (error) throw error;

      msg.style.color = "#16a34a"; // verde
      msg.textContent = "Login realizado! Redirecionando...";
      localStorage.setItem("sessaoSupabase", JSON.stringify(data.session));

      setTimeout(() => window.location.href = "importar.html", 800);
    } catch (err) {
      msg.style.color = "#f87171";
      msg.textContent = "Email ou senha inválidos";
      console.error(err);
    }
  });
</script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
